<html> 
<head>
	<meta charset="utf-8">
	<link rel="stylesheet" type="text/css" href="public/Stylesheets/req1style.css">
</head>
<body bgcolor = #DEE9F9>
	{{ template "Back" }}
	<table width=80% id="table1">
	<tbody>
		<tr>
			<td align="center">Номер зачётной книжки</td>
			<td align="center">Дата рождения</td>
			<td align="center">Номер группы</td>
			<td align="center">Фамилия</td>
			<td align="center">Тема</td>
			<td align="center">Оценка</td>
		</tr>
		<tr>
			{{ range $index, $elem := . }}
			<td align="center">{{$elem.RecordBookNum}}</td>
			<td align="center">{{$elem.Birthday}}</td>
			<td align="center">{{$elem.GroupName}}</td>
			<td align="center">{{$elem.LastName}}</td>
			<td align="center" id="td1">
				<p><input class="texti" name="theme" required type="text" pattern="[az-Az]" placeholder="Проектирование подъемного механизма" id="in1"></p>
			</td>
				<p><td align="center" id="td2"><input class="texti" name="theme" required type="text" pattern="[1-5]" placeholder="5" id="in2"></td>
			<td align="center" class="td2" id="input"><input class="but" id="el" type="submit" value="Выполнить"></td>
			</tr></p>
			{{ end }}
	</tbody>
	</table>
	<input class="but" id="send" type="submit" value="Выполнить" onclick="sendm()">
{{ template "Exit" }}
</body>

<script>
( function() {
	rows = document.getElementById("table1").getElementsByTagName("tr");
	for (var i=1; i<rows.length; i++) {
		var tr = rows[i];
		td_but = tr.cells[6];
		but = td_but.firstElementChild;
		rows[i].cells[6].firstElementChild.onclick = function() {
			if (this.value === 'Выполнить') {
				tr = this.parentElement.parentElement;
				var theme_td = tr.cells[4];
				theme_value = theme_td.getElementsByTagName('input')[0].value;
				theme_td.innerHTML = theme_value;
				var mark_td = tr.cells[5];
				mark_value = mark_td.getElementsByTagName('input')[0].value;
				mark_td.innerHTML = mark_value;
			}
		}
	}

 })();
function sendm() {
	var xhttp = new XMLHttpRequest();
	var table = document.getElementById("table1");
	var out = [];
	for (var r=1; r<table.rows.length; r++) {
		out[out.length] = table.rows[r].cells[2].innerHTML;
	}
	xhttp.open("GET", "marks", false);
	xhttp.setRequestHeader("Content-type", "application/json");
	JSON.stringify(out)
	xhttp.send(out);
}
</script>